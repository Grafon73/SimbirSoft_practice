databaseChangeLog:

  - changeSet:
      id: DEV-1
      author: grafon
      changes:
        -sql:
          sql:
            create table author (
            author_id integer generated by default as identity,
            birth_date timestamp,
            create_date timestamp with time zone,
            first_name varchar(255) not null,
            last_name varchar(255) not null,
            middle_name varchar(255),
            update_date timestamp with time zone,
            version integer,
            primary key (author_id)
            )


            create table authorities (
            username varchar(255) not null,
            authority varchar(255),
            primary key (username)
            )

            create table book (
            book_id integer generated by default as identity,
            admission_date timestamp,
            create_date timestamp with time zone,
            name varchar(255) not null,
            publication_date timestamp,
            update_date timestamp with time zone,
            version integer,
            author_id integer not null,
            primary key (book_id)
            )

            create table book_genre (
            book_id integer not null,
            genre_id integer not null,
            primary key (book_id, genre_id)
            )

            create table genre (
            genre_id integer generated by default as identity,
            create_date timestamp with time zone,
            genre_name varchar(255) not null,
            update_date timestamp with time zone,
            version integer,
            primary key (genre_id)
            )

            create table library_card (
            card_id integer generated by default as identity,
            create_date timestamp with time zone,
            in_library boolean,
            return_date timestamp with time zone,
            update_date timestamp with time zone,
            version integer,
            book_book_id integer,
            person_person_id integer,
            primary key (card_id)
            )

            create table person (
            person_id integer generated by default as identity,
            birth_date timestamp,
            create_date timestamp with time zone,
            first_name varchar(255) not null,
            last_name varchar(255) not null,
            middle_name varchar(255),
            update_date timestamp with time zone,
            version integer,
            primary key (person_id)
            )

            create table users (
            username varchar(255) not null,
            enabled boolean not null,
            password varchar(255),
            primary key (username)
            )

            alter table book
            add constraint FKklnrv3weler2ftkweewlky958
            foreign key (author_id)
            references author

            alter table book_genre
            add constraint FK8l6ops8exmjrlr89hmfow4mmo
            foreign key (genre_id)
            references genre

            alter table book_genre
            add constraint FK52evq6pdc5ypanf41bij5u218
            foreign key (book_id)
            references book

            alter table library_card
            add constraint FK8eb0djgj3qev1cpjgeccjr65d
            foreign key (book_book_id)
            references book

            alter table library_card
            add constraint FK8w3g0x8n0o4fm5p0rrmm4qnwi
            foreign key (person_person_id)
            references person

            INSERT INTO AUTHOR(VERSION, FIRST_NAME, LAST_NAME, MIDDLE_NAME, BIRTH_DATE, CREATE_DATE, UPDATE_DATE) VALUES
            (0, 'Илья', 'Бугынин', 'Витальевич', '2019-11-19', now(), null),
            (0, 'Дмитрий', 'Ипастов', 'Олегович', '2020-11-19', now(),null),
            (0, 'Виталий', 'Горин', 'Александрович', '2018-11-19',now(), null),
            (0, 'Олег', 'Резин', 'Степанович', '2017-11-19', now(), null),
            (0, 'Иван', 'Бочкин', 'Евгеньевич', '2016-11-19', now(), null);

            INSERT INTO GENRE(VERSION,GENRE_NAME, CREATE_DATE, UPDATE_DATE) VALUES
            (0, 'Ужасы', now(), null),
            (0, 'Фантастика', now(), null),
            (0, 'Приключения', now(), null),
            (0, 'Драма', now(), null),
            (0, 'Детектив',now(), null);

            INSERT INTO PERSON(VERSION, BIRTH_DATE, FIRST_NAME, LAST_NAME, MIDDLE_NAME, CREATE_DATE, UPDATE_DATE) VALUES
            (0, '2001-01-01', 'Олег', 'Резин', 'Степанович', now(), null),
            (0, '2001-01-01', 'Иван', 'Бочкин', 'Евгеньевич', now(), null),
            (0, '2001-01-01', 'Дмитрий', 'Королев', 'Иванович', now(), null),
            (0, '2001-01-01', 'Егор', 'Лапин', 'Валерьевич', now(), null),
            (0, '2001-01-01', 'Александр', 'Белугин', 'Александрович', now(), null);

            INSERT INTO BOOK (VERSION, NAME, AUTHOR_ID, ADMISSION_DATE, PUBLICATION_DATE, CREATE_DATE, UPDATE_DATE) VALUES
            (0, 'Удивительное приключение',1,'2020-11-19','2020-11-18', now(), null),
            (0, 'Страна чудес',2,'2020-11-19','2019-11-18', now(),null),
            (0, 'Битва',3,'2020-11-19','2018-11-18', now(), null),
            (0, 'За горизонтом',4,'2020-11-19','2017-11-18', now(), null),
            (0, 'Светлое будущее',3,'2020-11-19','2016-11-18', now(), null),
            (0, 'Цвет красок',1,'2020-11-19','2015-11-18', now(), null),
            (0, 'Земля будущего',5,'2020-11-19','2014-11-18', now(), null);

            INSERT INTO BOOK_GENRE  (BOOK_ID, GENRE_ID) VALUES
            (1,1),
            (1,2),
            (1,3),
            (2,2),
            (2,1),
            (3,1),
            (4,1),
            (3,3),
            (4,4),
            (5,5),
            (6,1),
            (7,1);

            INSERT INTO LIBRARY_CARD(CARD_ID, BOOK_BOOK_ID, PERSON_PERSON_ID,VERSION, CREATE_DATE, RETURN_DATE, UPDATE_DATE, IN_LIBRARY) VALUES
            (1,1,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-18T08:51:52.447763100+04:00[Europe/Samara]',null,true),
            (2,2,2,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-18T08:51:52.447763100+04:00[Europe/Samara]',null,true),
            (3,3,3,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,true),
            (4,6,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,true),
            (5,7,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,true),
            (6,1,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-18T08:51:52.447763100+04:00[Europe/Samara]',null,false),
            (7,2,2,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-18T08:51:52.447763100+04:00[Europe/Samara]',null,false),
            (8,3,3,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,false),
            (9,6,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,false),
            (10,7,1,0,'2020-11-19T08:51:52.447763100+04:00[Europe/Samara]','2020-11-26T08:51:52.447763100+04:00[Europe/Samara]',null,false);

            INSERT INTO users (username, password, enabled) VALUES
            ('admin','$2a$10$t5NAlUsRLszZokBz7P1cReOqrcWfeqKMEPFlO0Q1HtNcVB0JVALnK',1),
            ('1','$2y$12$qv5EH9tPkOtTe2DlKwkHVuyFc3LEaIWINEVRLZO04j5gcyl0EguVe',1);

            INSERT INTO authorities (username, authority) VALUES
            ('admin', 'ROLE_ADMIN'),
            ('1', 'ROLE_USER');

